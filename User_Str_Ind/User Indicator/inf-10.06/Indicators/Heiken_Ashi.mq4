<metadata>
7c4059668df5f9945d31634374028eeb4c3eaddeddb4a2cd2648bf82597be5d4aa84f6c6b7956040c5a03658d7b4432c4a2e97fe7b156f0898a54f6db8cd66126204614cefd7b6941d229ea045790568680745210772abc7caaff5d533454623b5c75427650c5d32dfb138055674d7e69fb1f8c844660c32122e97f92445a2cf74119ca280c89efbc3aa8de6d7b28de36d4d6c2d4b38167e8de4d7eb547b3957d9b89df02540407e5c60ee9a265f8efeb3d6cef0abe236585e3a2e475a396c0dafdbcda2c4b6310d230c3d49017890e016731628d8e4ef83aacb9bf56601b1c42c4d690e1d78033df5b897c6226e41757e42e6c94824d9b86d033e59dda8670695f24f2a9ca27e4254351b6e3f4b076f18772d5f340a5038c1b5afdb4333dae0c0ef321d7c0b5c2bbacdd5fb3954711447332140b8c934414b24cabeb9dc691a507eb0def590d4a06f5392bdee8fa8ddb5c16109abc42a5885bb0a36dcbf0966fb963343a9c88be5374e437d74379af5b8d5fd8d6e0f9df3daa33509654ad4b7ed8282efc8b8b4d5254be891b38d0d31ee8d432c0469aec3523794fa2c5888fbbe805f6385aa83e09af59bf6a6cb6401c8a6ed99b9cafac492aef99a5639c7b7c7be7e0cbcd5adca147c9ce8681b3a04f6b5f9962858582166141a73d9beb1d940343212da7360406c5e5969f1c1be8a082496b6622fd5b0b2c6a6c7d38284f19ef1c4b06005592a0424df8c117ef0963347d2a54a2b2c5efb9e89a9afec5c33abd99fefbe90a09c08279bf836592454334a384acfa6a2c5d0b81d694e3dd2ec2f1301654f2e1662086ddc93d3b5e5a6e092bedb99f8ccb8573e0d6285eb4779f8c9c3fbfbd5e5d50137cbe5fbc9c8f866579dafe3dff7d881e5d9b8a8dcb9dc28675b3d084b4a381e7be889b0c42f46553a86e83709774b6500d8a06616a2e63f5e592d9ffa82bca29257669ab41d2daa9b1a343b0b8cbc82b2eadbfcc0f7d898fd631b205044007617c7b398fd013f0a36ff8ffa9b3d4ea8db097e97f8c7b5fd99c6f8467a98b7cdbd4120394a7201f087721dee9c2246437d3408f792265e46275e30004c85e4214f7215f0cef9a95c2ed5bad2867103abca026635506e1c773b35544c22deb9156069087d1ab8ddecd0604f127780f87617d9b78cc04c2d95fb5a3d182696aa433171140066e6835b29aacfe7896102fd9835460b351c20becc1a7f6c0a4c2996e4bdd892fc7d1e7015506e48132500cc9c86d4dd923176aaf819584b06a88d1d40f8a4baea46278eedf59eee8fe88f1b7e6b181844e48968193b57182cb997dcacf49725481f23103f7507f095a4c26500176583e63a545e3d771236087c406f40d5a7badf4127f19490e25f3a28462b48096cec9fc2fc1529e08988e62145cea799faa8c915617f1093e1024d48387b0f4e274926e688c5b61a3a2152096c7f0f65043b491170027660053e03ebc91b5d6001b5d9a2d10267b597a7994a76117dc9a0c5ab27426848c8a64e2f305d3c599aa73a18206cd2bbdeb0eb8e2d0d2b1a1133cded4724503f1975a1ced0a2cbf6dcfe2e033f0e3e084d7af8cf4176be8c9eaf3d0b3416ae8e7c0f57231e67bfd38eeb2a17efcddcecb7952d0ddcab1b72afcbc2b65c3494a9567407362507f1d17a09334a2548c0a24e213955e0ddf4d692a0eedf3c0b87a55777087e620b7c0fec852d4f3f533b5e3d0097b5356182f02257fe9b193bfdc3a79be3cc7b1710796d032144bb85f8c4b6daaac3dcb2f396183898f62a4bd8b567023b06dbf9014dc2ab4a2441240525d0e18aa8f0d0315287e83a56244bf7852419381a163be2d3f1c7a79096a10433caf877460234e2c0bc9ccfbc522670090569ceabd3ee735190a0cfed37170176c1a895f1e397325a4f721032ebdaa18358785e2d057c701dd8ba187781ed4d704163f7c565545265cdef4262f1874c25f281aec785e7503c0366c4f9c1e37f2b7103b6c34f2af6d4c6f87b4790bfa9c5036ac1af2d48516f033f6408244d9ff1d9bc5d7d82ecbbdaf598d5b0b885674525691871b9d7cfaa6949ac9e3e1c5d7d2a493e51761a9af53e4c25185476361b3006b88dcffa0c3f2c1a3a18c4e40a790e7a8cf5127e82e7310c2b09a19170521d3d93e4036ae2861a6e7d15467be9cba192ebc906269eed94ed3b56c6a4cba46b07edd0f1d3390b85b47146092b7151fa8c375e43303b527d1f5f331570023f9cbe93c7c5b71267c9acccee92acd3ef3d12432fc2ab214f94f1cbf5b78b4f233851b7d985e01b3b5a34e786f19c93f684b93b19b5f979108ae44d288bab6d5e7a58c5e54c2f4926f19d523d84f62a170624cee3c6f7b785ad99e3da6e5ea795e5d23d0c2301644421524135720b5b374f2afdc08fada393d6f4bb9b7c0b81e8e682384c9ef6310ce4c65764a785341492e1b0c97b163250e28d7b17605dffdd88ba52630a3dfad807271167650c5023b0d994f696fab9dcb28f41637521f587a2d76a0f2002724cdfe37e51a2ce046deb8589ec5f61bb87311ed3bac6a877130b62adceb6d7e490315e40328fc06b1b4b3fbbd25e31a0ce1a6999a7b8840d7ecda8fc8e1e771b7e67142f11bff90968f894bdce3752063a2a05f78461046d1f244d83e60a7981bfb68afd8f4c29d1a5194d9ce57c0c7510211fbafe6b04a8dd0a688ee2bbdeb38f6d42582a98fd255180d4166f8bfbeb8ee1dfba867b16dbbab5cd5012e081f3815e2d81c393f27b180e65efd10030122e2a0585e82948ed9588ca1574a3d15221e7a51574b8db4823d9e714288fea751bf293fb99a8c4a3c68ecf3c5024417f0d097df28191afe5a38feea9c5592a1570c4f8e0cf2e4b84ea47260466aec20e6bf5b49ff371142b5942362e5da6983804b2d7b9d7e283a8ca600c0c691e5ddeb3d2a6493b6e17774985c34c2d5e32adde2f4a576b06297d18b2dc9ffe91f3412db0d51a597c11afdb4e3c9ee7e8d6231f82e7c4aaabca75172e423b5e2a63e18f0571e597224388ea2f4e0b7998a6c086a0c158347c0facc90834af804227b6d883e234569ff3d7b21e57ef810377ccbe026395f701606b195c62261ab39c87ea6807fd99d0a52844debb36085e9fb19ce7c647428c1032db0084a7b8
</metadata>
//+------------------------------------------------------------------+
//|                                                  Heiken Ashi.mq4 |
//|                      Copyright c 2004, MetaQuotes Software Corp. |
//|                                        http://www.metaquotes.net |
//+------------------------------------------------------------------+
//| Modified by Flaab. flaab.mrlinux@gmail.com
//+------------------------------------------------------------------+
//| For Heiken Ashi we recommend next chart settings ( press F8 or   |
//| select on menu 'Charts'->'Properties...'):                       |
//|  - On 'Color' Tab select 'Black' for 'Line Graph'                |
//|  - On 'Common' Tab disable 'Chart on Foreground' checkbox and    |
//|    select 'Line Chart' radiobutton                               |
//+------------------------------------------------------------------+
#property copyright "Copyright © 2004, MetaQuotes Software Corp."
#property link      "http://www.metaquotes.net"

#property indicator_chart_window
#property indicator_buffers 4
#property indicator_color1 Black
#property indicator_color2 Black
#property indicator_color3 Red
#property indicator_color4 RoyalBlue
#property indicator_width1 1
#property indicator_width2 1
#property indicator_width3 3
#property indicator_width4 3

//----
extern color color1 = indicator_color1;
extern color color2 = indicator_color2;
extern color color3 = indicator_color3;
extern color color4 = indicator_color4;
//---- buffers
double ExtMapBuffer1[];
double ExtMapBuffer2[];
double ExtMapBuffer3[];
double ExtMapBuffer4[];
//----
int ExtCountedBars=0;
//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//|------------------------------------------------------------------|
int init()
  {
//---- indicators
   SetIndexStyle(0,DRAW_HISTOGRAM, 0, indicator_width1, color1);
   SetIndexBuffer(0, ExtMapBuffer1);
   SetIndexStyle(1,DRAW_HISTOGRAM, 0, indicator_width2, color2);
   SetIndexBuffer(1, ExtMapBuffer2);
   SetIndexStyle(2,DRAW_HISTOGRAM, 0, indicator_width3, color3);
   SetIndexBuffer(2, ExtMapBuffer3);
   SetIndexStyle(3,DRAW_HISTOGRAM, 0, indicator_width4, color4);
   SetIndexBuffer(3, ExtMapBuffer4);
//----
   SetIndexDrawBegin(0,10);
   SetIndexDrawBegin(1,10);
   SetIndexDrawBegin(2,10);
   SetIndexDrawBegin(3,10);
//---- indicator buffers mapping
   SetIndexBuffer(0,ExtMapBuffer1);    
   SetIndexBuffer(1,ExtMapBuffer2);    
   SetIndexBuffer(2,ExtMapBuffer3);    // Open
   SetIndexBuffer(3,ExtMapBuffer4);    // Close
//---- initialization done
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator deinitialization function                       |
//+------------------------------------------------------------------+
int deinit()
  {
//---- TODO: add your code here
   
//----
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator iteration function                              |
//+------------------------------------------------------------------+
int start()
  {
   double haOpen, haHigh, haLow, haClose;
   if(Bars<=10) return(0);
   ExtCountedBars=IndicatorCounted();
//---- check for possible errors
   if (ExtCountedBars<0) return(-1);
//---- last counted bar will be recounted
   if (ExtCountedBars>0) ExtCountedBars--;
   int pos=Bars-ExtCountedBars-1;
   while(pos>=0)
     {
      // Value calculation
      haOpen=(ExtMapBuffer3[pos+1]+ExtMapBuffer4[pos+1])/2;
      haClose=(Open[pos]+High[pos]+Low[pos]+Close[pos])/4;
      haHigh=MathMax(High[pos], MathMax(haOpen, haClose));
      haLow=MathMin(Low[pos], MathMin(haOpen, haClose));
      
      // Store in buffer
      if (haOpen<haClose) 
        {
         ExtMapBuffer1[pos]=haLow;
         ExtMapBuffer2[pos]=haHigh;
        } 
      else
        {
         ExtMapBuffer1[pos]=haHigh;
         ExtMapBuffer2[pos]=haLow;
        } 
      ExtMapBuffer3[pos]=haOpen;
      ExtMapBuffer4[pos]=haClose;
 	   pos--;
     }
//----
   return(0);
  }
//+------------------------------------------------------------------+