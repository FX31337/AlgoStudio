<metadata>
d7eb457a9fe7fc9159357050f385c1a46b196e1dfd94d5bac5abd9e4ebc9d1e07b553b0b1537381898fd7f11c2a1670800643851abc502651b261331e693ea9e711789a487bf1e3cb887c3fd370bd4b92e416a0e12671e72583df7d75523e98c0e7c552683ea345bf49aae936c4ee8d9f6d8eede0e2cdde3b68a4e201c7d8ae7ec89caf4eaa263064d24e78c3c59385641000e7dbdd586efe7a85d2ea9cae28b412d553986e7740029464a383804ac833b5584e50e63c2a7eed01b275b2f5821e0901a7fd9e70e475b35781c0e678cefaacbe793355a6f1d80bc715e4430d0a96414c5a08bb56c505b371d7ccfa1365185f07e1fd7b05b3e1628fdb0d48594d87a4e88b4705f45292445ec8231566411b0d190f756338cb2e0dc87e6b0c582f6dcb4d7b8e0920e301870a9dd9de96313e7ddba957a5562151c6b5f28e8c66b1b610ee881a3cd7c0887fd62071163fe91674acda4107e5b3f21488dee15747e0a3758cab8a7890c6f721d39545b67406fa8c93e4b3e4ac6ae432c32409aa494a853307718cea32b5b7918d3bd8ef793ad17546e0188e5bbcb3e5fc7a9b0c9d2ee0e21294ad3bcdcb1ee9e365792fcc1b82719625e5e3dddb2d6bbd9b4016467098afea7d4300e0c30654a7a199ef1f79aadc0bedb741a6f1b1d6ea49a330f7c1fef802b5bf48d93e1eb8296f16109acd8681bd4ea0241d7b80f7f3c4582f0f69ffb9cb3dbbfcba989329bb999f4a467083e574c229befb8c2593c92e0254a537e274e731d553109604526e081f185630cb9cb1b357714305fbbd60539351a187b86e90a7a047de391a4cde285eb8392e6c5b6ba84b589046060013145fe9b7639f99f81c21b6904617213e4901178741b3b5580be8dbc5d65aa8474440630301e35074474e9d8f3c15e6298b7cbafa9c8ed992c49e7a8c7a1b4f757256e0be786ec98b0d9d1be7a14f0ce84b802672159710126625d3c7a0ea2c7201e516140717d535b6b6859a28c5c6ce9d9e6d6d6e72e128fa0a2c7b0c896e692d642234430d6b30836f7cbd9a9e4856f1c3d4e394e630c0c7edbbfc0fe467a8fa070001b7a94e744373a4de38cb9cb197d271982be6603aed66302432da3effc9d1f714e29013f5c0c285aff900551c4b68aeb5337791c780acc808dec741ab1d6196c1170c7a0294cdce080afec89ed9502635836511d6c0dc8a6c9ae241a1c202f5d086d6b0df095cdbf0b6e28460d6e4d284330754b2a161d6fa5c09afc492cd1a34e2b0769f390e98c9ca2e7bce4c1cf9ffaa8e8a76423217305445d10193c401da6fafbab7312bcdfe88376179afd4f2a42317f23c2af12631f7312268ca248388cef0568467a6b44fb89f693dcbad5b0384a91f47816a6c54722c4fadfe30f207c0e9df81274711498ea2e4b711f77140e6b1665655b427e650c305e482ceb82660588e9f682b5dae694b8f7e292136799f00f60fb95fd8e20004437620746365e3ffd8f34550d79d5b0b08d6f4df0a43a481366bdd801230937073bc8a483eaa9c7f792e0c0593716776409ee8b2b164765410d4a23e789d0b5b090221316347e5e4625503f177b6609c3b1edd05476b19cecdda591192e281f5b6f1f2f84b58cbb8ba9e5c51f6c0175b7ced1bd50353e031c3e241481a34a6ab4c384edd3b72652cba3f9c43311c8fa0a28c1e16516b8c1274af89af7981b77615cd4f6c6f4eddc5a6deecc2c0cbccacca5cdbee78e0567660a1277f4c9be9c792d7e0ca2d78aeffbd9e4da467a85aa711dd0b9fc92a3c691af96aa462a5a334a24d8bd85a529477e1fa8c59efbc8f5c3e1a7ebc2ab8ae4503589a9c1f08daf37171b78fc93513dadc2daa8a09da381567b7c4a8bbe87b20a397244391bd9f9e0932e5a3b42274bb4d1bf825f7d56662d0fc0e07a0d85ec4a2ee0941c744f72eac8d0e28cae1636651695ec1d70187a701f4824f7caf6d4340678498cbbbf9df0d0c6b03851aad90e67c6a4b1ddf194c4f90f2d792d92e0ee9bcaaf7052dbe5e8d4644b85e93f56fa9486e3dde399a585e9afc6422cc9ac96b6c6a83e5fa8c54025526f3e1c317d2a43f49a6e0b03233705381a1c3c8be8d1bee28eb1de1c6eecd1c6e42d0088b9695f52653c08dfebffcc98aadfefbd9f58784231a9dd2851a0cc026786bb092ba393f6d482a24d3a2940a1c52551127a9aa7dbf9d7e6785ac7e7cfbca0d9bcd1caa8cba40a6683be446602309eafaf988ba94b6bdcaabbd2483b83ea791b3b57b7d28fb2f8daa8fc3042b1c41c79ba982a14b18d6c43bdd1aac3fa94d2b785bb6a56230ccea74927650192fba0c302635024650afd8f9bd46b1b097d573ed3bcb0defc8fb886083493e0b9dcfd8f8be24e2bbecd94aa9ed88aebb0dca0d371148eb2c2ed0f7c4a2f30429bf23356a6d5d3ed4b77a5d752374135f0a4057ce5952b4eb886b6f25b34780de183b5d91c79407cebc489fb57322551beea0f7637475035447a1d21402d6100770f387a8bea4a38c3b00745086967043c5793adb5856c503b14e78a056490e8dd9f67065d2f60134103d0b11f7c9df61d23b88466036e00f1906002d5b9e7820e4ff9955b3e790b7c0889fa625c7b3d11701874562572174975cee1583d0e6070113f5df8941174b0f1751999fc2e5c88fc81f22b15102c24410769127336549ef267024300137e3f4b2b59a6df9aa4efa991f0cea2fd8ee98c5965af8025402947c3a28fed5f33086d0645fd904236ea9899e0300e291581e45e309afb65076d01aacf6a231d7394e0cfbd7514d5b71d7c9deff7c947011475016dbccff3964e72fcd381e4f09e1b7a5d3f8ae6c8ad3871a7c990e4186a2b4aa8cadebf0a78caf4a69aa38cd1bc2d42690d2a5fe488e88d0b3563b023a41207d3a297217c9d0b95f9a6
</metadata>
//+------------------------------------------------------------------+
//| HeikenAshiOscillator.mq4
//| Copyright http://www.pointzero-indicator.com
//+------------------------------------------------------------------+

#property copyright "Copyright © Pointzero-indicator.com"
#property link      "http://www.pointzero-indicator.com"

#property indicator_separate_window
#property indicator_buffers 3
#property indicator_color1 DodgerBlue
#property indicator_color2 Red
#property indicator_color3 Teal
#property indicator_width1 2
#property indicator_width2 2
#property indicator_width3 1
#define MaMetod 2

//-------------------------------
// External variables
//-------------------------------
extern int AvPeriod = 2;

//-------------------------------
// Buffers
//-------------------------------

double FextMapBuffer1[];
double FextMapBuffer2[];
double FextMapBuffer3[];
double FextMapBuffer4[];
double FextMapBuffer5[];

//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//|------------------------------------------------------------------|
int init()
{
   // Total buffers
   IndicatorBuffers(5);
   
   // Visible buffers
   SetIndexStyle(0,DRAW_HISTOGRAM, 0, indicator_width1, indicator_color1);
   SetIndexBuffer(0, FextMapBuffer1);
   SetIndexStyle(1,DRAW_HISTOGRAM, 0, indicator_width2, indicator_color2);
   SetIndexBuffer(1, FextMapBuffer2);
   SetIndexStyle(3,DRAW_LINE, 0, indicator_width3, indicator_color3);
   SetIndexBuffer(2,FextMapBuffer3);    
   
   // Internal
   SetIndexBuffer(3,FextMapBuffer4);  
   SetIndexBuffer(4,FextMapBuffer5);     
   
   // My name
   IndicatorShortName("Heiken Ashi Oscillator");
   Comment("Copyright © http://www.pointzero-indicator.com");
   return(0);
}

//+------------------------------------------------------------------+
//| Custom indicator deinitialization function                       |
//+------------------------------------------------------------------+
int deinit()
{
   return(0);
}

//+------------------------------------------------------------------+
//| Custom indicator iteration function                              |
//+------------------------------------------------------------------+
int start()
{
   // Start, limit, etc..
   int start = 0;
   int limit;
   int counted_bars = IndicatorCounted();
   if(Bars<=10) return(0);
   
   // nothing else to do?
   if(counted_bars < 0) 
       return(-1);

   // do not check repeated bars
   limit = Bars - 1 - counted_bars;
   
   // Check heiken ashi for past to present
   for(int pos = limit; pos >= start; pos--)
   {  
      // Open and close 
      double open = iCustom(Symbol(), 0, "Heiken Ashi", 2, pos);
      double close = iCustom(Symbol(), 0, "Heiken Ashi", 3, pos);
      
      // Median
      FextMapBuffer4[pos] = (open + close) / 2;
      
      // Difference
      FextMapBuffer5[pos] = FextMapBuffer4[pos] - FextMapBuffer4[pos+1];

      // If bearish
      if(open > close)
      {
         FextMapBuffer2[pos] = FextMapBuffer5[pos];
         FextMapBuffer1[pos] = 0;
         
      // If bullish
      } else {
         
         FextMapBuffer1[pos] = FextMapBuffer5[pos];
         FextMapBuffer2[pos] = 0;
      }
   }
   
   // Apply average
   for(int i=0; i<Bars; i++) FextMapBuffer3[i] = iMAOnArray(FextMapBuffer5, Bars, AvPeriod, 0, MaMetod, i);
   return(0);
}