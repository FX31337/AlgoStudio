<metadata>
24183d025820224f14786b4b2c5a33565725afdc0960bfd082ec28159fbdfecf755b0c3c4a68eccc94f1a8c66407d4bb5b3fc5ac1e701b7c5469b2905d281b6f2543210c3008b391ead57e40e6daf79aea85bfdbd9ac553985e09ebee69071146b197d0e9bf284eb137d25182b096150d4fa53633210f5cbe5d9b2dc8aebf994d1b4d1efcf8dbedf630d4f2b8af9261a4e61a2cc274678157c19f2cce5d9f480621b2c5c0663645ad59c553b94f0432a6003d7b6e1951d724230330f90bfd3a797ee6818e683d1ef0c30c3af670682ec7314add8eb8ad7b0b5d0ccf27b367c2dc488bb8f93af527d1579f09199f71f788bfe0362bbdc3055ab95bb8788e92752780cf69e49267301764881e93b4f1f6b25554f756a45edc2c7b037402f58210f127f02679ce8fe9f2f5e3742422d295d7a1f780bdef0a2ccb4d1dbaf7956b08cc1ee5938d6a34632a4cc5a3596e4a09e033f204347286e033b4b5534a9c7c7be340a8ecdbad5402ded9d28499cf2b0c94d71e8c783e0523d9af7f181f899caa4661f86b8efd31b78f39c4b262f422f4aec823d491360251b25190629711285ea2f425c31a7c26a04add95a29d3ed99a52744b7d8b0c07d042153cfa6c2a5d5bddda9f182dde3d192305f3e4e5b2291e3e38aec8bc2aa2054c8e87fd68faf754785b5c5f5ccf9eac69ebed994afca80f4a8c97f2e4633adc211655b3e86f5fadaf1a2cea11670e19532451f7ef88a96f32f0f9dde16793c4e0e7eb79980bc426d4b2817783d4d245dd9abb7de99fe7c14c3b79deef9c70d317e1a3f5e097d2e4bdb94a8cef3b034460065781975015f36056a680689b7ecde2d1b527c4676192f5f71f7c5aa9adaebc2f0a498012ea7c3c3a22f5bb8dd1956d0b61a59aad8caaf0160592dd1b8c1ae86e84b753b076b0e0e766616b5f1c4a553277a1fc6f80b3b4677b6988ebe6554ecc2a1916a5acafaae9fd7eb8da26c09433bdaaa3b7f7110592d6207407ed1edb2c2a7c6364589fac9bee38c0674bdd99ba5b488b39cf3830362d2a1aedd6a1df699f1838febf3cdedd1d8bd770f9afbbcd2b0fcb0d1a5cbf295dfe127775220f09f5e0a0a78ceaf3652a6c3e6947a367c1dee80335463162e4f781fc3a6a498e3cc07620d75c9a8741afcb07d1c6b05d0b777491b27b2c0dcb9cea82144b1c37510157b81e232575a29102ef6caa7d588edd3b5caaf23510d6899f7cfacd6b368566338d8fd6333396b81ce4205bceeaced3e73d2f75409c79b83d31d7c1774503bf1906205b7d2483b124e026fef9efa96ab9f97b913636300a4c9a79b90bfee9c16730c6ae580dba97510395722411075cdf355699ab54436a4c15f397f1a4b395e3b7b15b4d794f1abd849773b07a1c8315fff9ba2cb7615c0a19aee4c23a4d678371b6b5c28016895faa4ca582b1838b0c3395c374785e4cab80968a0d40366a39e082a85c3d5b4aec2bfcca7c2d8fa5c628ab625491d74e58b492cf3d36a042445b0dd98fd68553210fdb1543d016f8ce9be9e1c2d597b103041227f109af6aac5166448755476072a5c6d27135c6a9ba8182c36057143b78197b58cace497f3873b42f29ebcd954695d7f6555c9ebcbeb2354a3ca4024ea9e2f47f4c9624097a673518dad5526ccb5305dbad8b9d6a6caae9389abd1e39daccef9cfed133387f1fc9581f285ece1835935e98c78452d0fdc88fb89a0d5c7a2cceef4ca5c604e61a8c4f29b412f6d08bb85dce0462a0069a8c66a0ff5d5bcd21071523f94f15865b5977e3260093d53b9dc9bbb4170e1c348687417432cbed26c034634e7daeac8664bb081d3e76b5d8ebd1e2a586b81b3f1c7a1839bbb5526c2b60871f09c2c49aa974d6f3b0b9ebce0c07a0ded846c085f2b036ba29f4c6e85b475574565e1924a33600de58780ef3a56ae9385a75e6cf7c66255a88a785888fe234a7e0d9cf51b798ee25f3aaf920b294a1e7507483d9efbfcde0c326d51a58a97fb97fe1e707b1e1729cef2c4a881e8c2ac94f12303a9c7fc9d99f40e6bbc810e2c4408b6df305ecda8d3f3e2d03e1cf1d10a697b146905264981f34b7643617855d1e0fdc963552a190e3ae6d5655755632e0ceccc9cef4337b3cae68a4c29a69b99bbfecef4d6715185f289e06307592d3c54764b9dbfecdd80a2bf9fc4b7037acca11371d4bb472b28154567c3f10332bf88dbf9bc9c502689e090e36e07bfdd86ea0c69b08d0624cb9f7d0f14616500e3c11628f8c4c1ee79151178d1bf096c2b154874ba953059a3cd98fcef863053bddcd7a3a7c885f70b4490e0384c066f2c438ee081f207392d11e093bfdae391660fdebb1b68d5ebe4a26302701c63105f3a132f3e11186b2b4edfad660f89ec92e1043a7a4689fb23461d69eeba99e0aada315494aa7034eb84f085395bec80fc993f0366496012f194ed99e4b0a3daf686ddb883bd2814a3cebedf5820d795b1d07406245794d62c4dbedd204b9ba53000bb873e11204d36579fe7c88ad2b3a1d3e39093d12a4b006397fc69577448ed88056b1574ef8dc6aac3a6501196fa5633661416620d7e102ec5835332d6bac5b6c7a22d11220ded880c62e382ff9d412d6f0a7e3f523e6b0ea6d44531a0d393ad320e284d8fe10869dfbd95f93c59367578156d193143fc85320cc2843150315d6516f69383bfc5ea2f4ad0be472685e7b9d53a5fe3a00b66a6d29eec275edfe1b28eaacf711f573632503d519df8e1a8d9b7e296007228495c3e79185321ba84a8eebedf9af632411570dbe74c632b4e492799f8f092315d3c59b8f1cca25c28c8ba016097f55a3b16642719310debc4f79a78175632c7b2204cbedb96a889a5daed7820d022b91eb9ae359a3ab2
</metadata>
//+------------------------------------------------------------------+
//|                                                        Bands.mq4 |
//|                      Copyright © 2005, MetaQuotes Software Corp. |
//|                                       http://www.metaquotes.net/ |
//+------------------------------------------------------------------+
#property copyright "Copyright © 2005, MetaQuotes Software Corp."
#property link      "http://www.metaquotes.net/"

#property indicator_chart_window
#property indicator_buffers 3
#property indicator_color1 LightSeaGreen
#property indicator_color2 LightSeaGreen
#property indicator_color3 LightSeaGreen
//---- indicator parameters
extern int    BandsPeriod=20;
extern int    BandsShift=0;
extern double BandsDeviations=2.0;
//---- buffers
double MovingBuffer[];
double UpperBuffer[];
double LowerBuffer[];
//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//+------------------------------------------------------------------+
int init()
  {
//---- indicators
   SetIndexStyle(0,DRAW_LINE);
   SetIndexBuffer(0,MovingBuffer);
   SetIndexStyle(1,DRAW_LINE);
   SetIndexBuffer(1,UpperBuffer);
   SetIndexStyle(2,DRAW_LINE);
   SetIndexBuffer(2,LowerBuffer);
//----
   SetIndexDrawBegin(0,BandsPeriod+BandsShift);
   SetIndexDrawBegin(1,BandsPeriod+BandsShift);
   SetIndexDrawBegin(2,BandsPeriod+BandsShift);
//----
   return(0);
  }
//+------------------------------------------------------------------+
//| Bollinger Bands                                                  |
//+------------------------------------------------------------------+
int start()
  {
   int    i,k,counted_bars=IndicatorCounted();
   double deviation;
   double sum,oldval,newres;
//----
   if(Bars<=BandsPeriod) return(0);
//---- initial zero
   if(counted_bars<1)
      for(i=1;i<=BandsPeriod;i++)
        {
         MovingBuffer[Bars-i]=EMPTY_VALUE;
         UpperBuffer[Bars-i]=EMPTY_VALUE;
         LowerBuffer[Bars-i]=EMPTY_VALUE;
        }
//----
   int limit=Bars-counted_bars;
   if(counted_bars>0) limit++;
   for(i=0; i<limit; i++)
      MovingBuffer[i]=iMA(NULL,0,BandsPeriod,BandsShift,MODE_SMA,PRICE_CLOSE,i);
//----
   i=Bars-BandsPeriod+1;
   if(counted_bars>BandsPeriod-1) i=Bars-counted_bars-1;
   while(i>=0)
     {
      sum=0.0;
      k=i+BandsPeriod-1;
      oldval=MovingBuffer[i];
      while(k>=i)
        {
         newres=Close[k]-oldval;
         sum+=newres*newres;
         k--;
        }
      deviation=BandsDeviations*MathSqrt(sum/BandsPeriod);;
      UpperBuffer[i]=oldval+deviation;
      LowerBuffer[i]=oldval-deviation;
      i--;
     }
//----
   return(0);
  }
//+------------------------------------------------------------------+