<metadata>
aa968bb4f28a167bc6aaa080ed9b8aef11633a49cca51d7266081d205d7fa495143ad3e3577587a7a9cc8ce21576e8873054670e5b353a5d35089ab81e6b2f5b9cfa022f162ef5d7c5fa7648f5c95c31533c1672f18485e999fc1f3f01779efbeb992f5c5e37e28dcea0714ccfed83b2103e32020426a29c764a503e86e7c7aab9dc744a2077b1d89cf0c3a7ff9a82f0391917441d6a335a335dec8baa8a5d14fb955d39a7c2d2aabc80f3dcd7b9ccad2d401f7aa698c4f85521542d95e598fdb78990d9620cd6b2aec7fe9d6b0a85f1aec134464874745b95e1ea932555d4b148762d116a067011157b5a3d5f2a6100e88fadc8a9973b765f0eeca0faced7eb715e006caecfec82197ea2d72d4c90f74b2ef1cfdbe758391d68295da3cbc3ac5624d8e6bd813f104726a6d3f682244cc1ae7e0c1c22c2fe6605fc938ee351211776e98785fc4b75fec2fed15132f19ea9c47e0e83e2c4aa2d54d1efaa96513293fc87ea3c514326711fcabeb6c5b789a1e8f182f2d20772c7b4284d95f1ba9a9feba9c6e2c283e00f6038568fe93851c1b38ce16a4a631782f0b3d699f7dabe557583ef6801741a27429cbc6002c5b7a4c11372e08b503f88fdcbbf9ae95777731c29479ebefd8d5f2ddcb5b3d0c3a620009dfe19715d3c0173daaeeb982e12a58a771493fca9c4264bb3d636585a2eb7c4340a221e8feca6c9d9a92b5281f39ef7b5d291f9dca864175769ad9191be7d1e355a6a1a3b42384aadc424437b13add90b788db3d5e9a6c24425582c2045a1eee98f8bc85022f39682e3afdb3f56c4ab137d7a4491a085b3c1efc8f91321af810f3d95a5dfef85bc2915cce39afea7c67f0b76131e5193f52b684230b7d2c4a5c7b3d1b8e887cea0516f14285f3a067eb2c2d296aacbf480c7a2605ed8e84f7ebc925767b485507e0b3bb888e9d99aabf4c8745bef8aa8d0f9891b5f2342384c1570c7f9c2fe463613720c7f61126215046b02709cf8437d2b17517e5323cdac5a29a1d215626e01d8aa37535769172bb2ddafdaa2d66414e99c1c68cdf3386376532e7e5d0fe7a8195ee3b14a0b5f1271542d704f1380c9e18f3f5bfd94294a5637a9ddc9a6c4b688fb1d419da1321de08fa6d32357e797dda889fd49773e02197ced954b2af997236f1b7a234d1176f8c60050d9ab553a1440ed9ffa9be5812045fe8c97dbdcbdafc15b3c13667011bbdc94f12418a58a3f5a0b7308693856bbf77110234d9ef90f31c0fcabd9d9bcf6904a2f9defceabfb950566bedb9cef0638e8d423517e1b4422ddb832405a3f402e7b18dcb9427c3962e4c14c1c0153a9e61255134171301c5184a10d501448e1b17e1f4e2dfa912d4cdeb91e7b05764a1645282352e8841521634d43335c3fa3ce320ee5ca6b1926433a5c3f5abcce7613f59ba0c325401a2496aab19ee496e1846f090d687002ef8ac3ad92f11174ef9c7d435a665039006ef3975831fb98402176020f6030429ad5473770043d54abc4305e0d7e90b087f45f3a21510b6afa88dabb8afe7217dee31230e7b353216e1b3356597bc0fec9f54c20365f147a0f6a0a2a711f4021274a3e5b82bf6f4d48047a13533d492c0f2f70415c7e416193f094fbdcb0ddb2ea98241996b4c2ef7f4e093f1126487f8dba3404695e93a4dcfe23033645bdc9621b432f4520102dd9fb81b13012f0d085f2ef8694f0add9bfd724192c0ec9f84d6f8bab92e1295018754c2ebdd2660a09341d3fa391cffe84b3ba980d2d5a2c93fac0b32f46a3c1b7dbe7828bb6c7e5520691e38efba3c66c4e724c9ba78ea199f50c655b3537521e20c8f47b5482eb325c711591f8d8bb41206713731c285a1659b3c3aade4a23bed1224c6e1dd5ebc8f489fa2c49e39158316e0bc8bbd9e7d1978fee65093d4e0663e5d9240b76053b5e285a0d64a3c6fa89c7f9f9c580f2a2c7d5a1396df0891d6de683f0ceeda927483d483e5c4824ceabfdc196b922503d586410702449307909a9cccbf5427ed5b8b9d8bcc4357787e627551162b8fa54353655a2c9b18fad9d0e3256797e134120265e44067b1a0f7d96e51b59fd9cfc9f7813536d4478b0d5fb9588e99bf9c6aa88ed91d0ff93dbbe2456b5c182f1dbe527618fee395584f74f2a8eb20926f0957e107110c8aaaac6bedb4100bdd11b7e5527a3d7a1d2d9e7d4e84025f19f0a6badcf8fe3cbae236088e52054bac8e29b2a1472347d1c9af67704c1a44874705f22478fe1a5c4e684523e56338dce81ec8afe6715ef96407ed1ed6c0995fb5d3c2d4f84e842270c456a04b0c4ddafdabb24466f0ec3b198a6a5e3b8d9167af18207624f738fa06207315f7b1a4e2cf79b701589c00f61bbcfcebc2b4acfad6b0a4a38e1df9ba7351a117c412e3e5af4815d316c09003ed7eab02cde2949cb0b64d30787df44ec
</metadata>
//---------------------------------------------------
// Project: SI
// Language: MQL4
// Type: Indicator
// Author: 
// Company: 
// Copyright: 
// Created: 16.12.2009
//---------------------------------------------------
#property indicator_separate_window
#property indicator_buffers 1
#property indicator_color1 DarkBlue
//---- input parameters
extern double T = 300.0;
//---- buffers
double ExtMapBuffer1[];
double SIBuffer[];
//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//+------------------------------------------------------------------+
int init()
  {
//---- indicators
   IndicatorBuffers(2);
   SetIndexStyle(0, DRAW_LINE);
   SetIndexBuffer(0, ExtMapBuffer1);
   SetIndexLabel(0, "Accumulation Swing Index");
   SetIndexBuffer(1, SIBuffer);
 //----
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator deinitialization function                       |
//+------------------------------------------------------------------+
int deinit()
  {
//----
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator iteration function                              |
//+------------------------------------------------------------------+
int start()
  {
   int counted_bars = IndicatorCounted();
//----
   int i, limit;
   double R, K, TR, ER, SH, Tpoints;
   if(counted_bars == 0) 
       limit = Bars - 1;
   if(counted_bars > 0) 
       limit = Bars - counted_bars;
   Tpoints = T*MarketInfo(Symbol(), MODE_POINT);
   for(i = limit; i >= 0; i--)
     {
       TR = iATR(Symbol(), 0, 1, i);
       if(Close[i+1] >= Low[i] && Close[i+1] <= High[i]) 
           ER = 0; 
       else 
         {
           if(Close[i+1] > High[i]) 
               ER = MathAbs(High[i] - Close[i+1]);
           if(Close[i+1] < Low[i]) 
               ER = MathAbs(Low[i] - Close[i+1]);
         }
       K = MathMax(MathAbs(High[i] - Close[i+1]), MathAbs(Low[i] - Close[i+1]));
       SH = MathAbs(Close[i+1] - Open[i+1]);
       R = TR - 0.5*ER + 0.25*SH;
       if(R == 0) 
           SIBuffer[i] = 0; 
       else 
           SIBuffer[i] = 50*(Close[i] - Close[i+1] + 0.5*(Close[i] - Open[i]) + 
                         0.25*(Close[i+1] - Open[i+1]))*(K / Tpoints) / R;
       ExtMapBuffer1[i] = ExtMapBuffer1[i+1] + SIBuffer[i];
     }
//----
   return(0);
  }
//+------------------------------------------------------------------+
