<metadata>
003cc2fd29512845701caf8f2650d4b19be91c6f1f764728f49a49748ba9b28326086f5ff5d79bbb85e0412f7a19006fc4a06e076907f4938eb3b6940673c5b17b1d5578162e624090af2719a29e4d20543b82e602777e129bfe9aba67113653cab884f76c057c13600ee2df3a183d0ccae4d1e181a32b15b488d2bc9cfd39549efbfac4420a47222c450368b6d380ee9fbff7b6f38091f9deb73b07406f8be594f5dfb2bcd984bab28e2b5fdba24d3d3a5f1c22125ba3cd1074e089f4971c7d93e74d226715063a80af99ed770e3f4f412428166f533b573f5e731d3354a8dd1071dabd7b1eead4ace1124388c4af9b1d21e3ccaec24223630d61060c795736781f67022f11a89491f0403541356f07cba4f88aab953978790c3f4bb5dd2e41becc417d745bd7b61f6ab5c1f39bcba42e5c4779241882e1442b87ea31417f1ef59b651c0937185b630cd3be9beb5a3be9876f160c307956cfac234ce38ea5d58feeee802c55b18f95a9a2c1a5ca305d0b66096c563802766e1d6d53e7db97b82a491877b6db83ee7613ef8141357d0eae90231f4c2f3c53e0903d4485f779108ee92a4286f2daa9ab95f3b01b74a9d92851abd99df4f99eee8600743e1e6b341a3a44763d0d04345b6fb29ee1c1216c2e4b32469ffed889e7921976bfcb472207740727d88bb6d9395f45315423f69771036702bd9d7a39e38ce795f787351b3c00d5fa7a1976194636bbc2ed9f224b187fed852a5e3d4e8fb1d5e92246b8d9790db4d1652a385ea4e73143b6d3680926521c755e31036d3f01b587e7de9ab48fbed0e2a688a4966d5d81b1d3eb8cb0a88724403b5aacd8b4d19bd482e45b18c8baa7c24d2cceba026b47285c3282bc1a266a0fbec6cfbfd59153323d4993f69ba599a9be8fe3cd51619fae527c6a5ad5e54878e7d69ba7c7e89cf94e360d7dd4907918c5b1583d655b18243848f495dcafb8cb0770224d98ea4f2b211f6854d9f6126253325b2836456116d9b6790b2246eed0efd39ef12451fe8aa2d25e2bacd876486b2f4379237f7b0be99bee810a609cf97d1ee1954d3e722e3f6fc8ba3659d581ddafe485a3c76b0e4a384b793c60f5a5a2f6c589125020552a43492593f721440173fda198facca5bdd3b6ea82c6d5b0a4c63f4a90f77d2185cc791705617019fb98afceadd9234c1163b9ca4c1088b43718b6d96114651140307f0ac1b5c9f7a09c8bf9dcb9aaccdbbec0b2c9acaac4ddbe73163546d2ecbd814d3fbdd8b8de4d284537debb1a74294acfaae1dfc5a8e0912a46b98dc5f9fad5c7b5e580ddbbf1948cfee184bfd13f5cf6936759d9e50d226614e88d2b4de18451235633b9d76300513494e7c6f8714d2841c3ad94f0701972115a3b0c784a25c3b1a1ee7909e195e0893857ef81c9ba2606f182f693acdcb4d523515435691df79219244c6e5412d5b494f8d2a1a9cca486506e6f533d51fb92d6b82e4b78588ee0debf026f4025b98495b7b5f9a3cadfb1781dd9f980b176543c1c157681ee1b77bdd2f486d6ebeecc4865467082b7784d083b380e391b240443305327344d5a365e3bc7fa3416d1e12d0fb898aed94029c6a21460ff97c3feccee4978486ac8f65864f7d8d2be5831305eee8b457b734fdab6bed72648cca9fedea8c6e18099f4c9ac477a3a186c200960620c0d681a3a9dace0c209296704b7d8d4b8325db0c29fa20624b39e67564a683b1ba4d7dbaf067faac64e2b0a376d4f0030684afbdba9dec8a136520074375f774ab79566575270bd83b884b49b0d611f761b7598fd447ab9856a06d3ba49274f2aac8cfe90c3a20568fa9fa598c2e07c3083ea127c12776d4d1725143645658be80d623b57e28d3547d8e5c1e3bb960d3b7b4e3c0963501b2d99bbe9c95a29fb8fcab3d8b47015fdc0f2d0c6f68ba9dbfb0176563ffc987c084b232e1372500c3fb597ae901e2281ae402cb6df2a44cda8c7f95a66761aff962648d6b353734e2032538ae7fd98526f0321efa37e17056bc8adb090e3d087a56a4aee8d7718563ad8b76311a994082a8ba64b7a4062f3d30370186cbfc60569bedb2e1391b3f1c1e8ca5777c3b4533a1d7994e0761ecff25b7985b62200a49a320eb29d315d026b204ebbdee0de0a36311e21481779bcd8ec85a7c49ffec0b4b3dcdfadc18eea9aa8dc670eb5dabfd1abd8e2dc83bff9d69ff2cea1d4b09aef1579a3c6fbc5b5563e8dcc5edd6be5cf1ac6594b9e1a
</metadata>
//+------------------------------------------------------------------+
//|                                                  Heiken Ashi.mq4 |
//|                      Copyright c 2004, MetaQuotes Software Corp. |
//|                                        http://www.metaquotes.net |
//+------------------------------------------------------------------+
//| For Heiken Ashi we recommend next chart settings ( press F8 or   |
//| select on menu 'Charts'->'Properties...'):                       |
//|  - On 'Color' Tab select 'Black' for 'Line Graph'                |
//|  - On 'Common' Tab disable 'Chart on Foreground' checkbox and    |
//|    select 'Line Chart' radiobutton                               |
//+------------------------------------------------------------------+
#property copyright "Copyright _ 2004, MetaQuotes Software Corp."
#property link      "http://www.metaquotes.net"

#property indicator_chart_window
#property indicator_buffers 4
#property indicator_color1 Red
#property indicator_color2 White
#property indicator_color3 Red
#property indicator_color4 White
#property indicator_width1 1
#property indicator_width2 1
#property indicator_width3 3
#property indicator_width4 3

//----
extern color color1 = Red;
extern color color2 = White;
extern color color3 = Red;
extern color color4 = White;
//---- buffers
double ExtMapBuffer1[];
double ExtMapBuffer2[];
double ExtMapBuffer3[];
double ExtMapBuffer4[];
//----
int ExtCountedBars=0;
//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//|------------------------------------------------------------------|
int init()
  {
//---- indicators
   SetIndexStyle(0,DRAW_HISTOGRAM, 0, 1, color1);
   SetIndexBuffer(0, ExtMapBuffer1);
   SetIndexStyle(1,DRAW_HISTOGRAM, 0, 1, color2);
   SetIndexBuffer(1, ExtMapBuffer2);
   SetIndexStyle(2,DRAW_HISTOGRAM, 0, 3, color3);
   SetIndexBuffer(2, ExtMapBuffer3);
   SetIndexStyle(3,DRAW_HISTOGRAM, 0, 3, color4);
   SetIndexBuffer(3, ExtMapBuffer4);
//----
   SetIndexDrawBegin(0,10);
   SetIndexDrawBegin(1,10);
   SetIndexDrawBegin(2,10);
   SetIndexDrawBegin(3,10);
//---- indicator buffers mapping
   SetIndexBuffer(0,ExtMapBuffer1);
   SetIndexBuffer(1,ExtMapBuffer2);
   SetIndexBuffer(2,ExtMapBuffer3);
   SetIndexBuffer(3,ExtMapBuffer4);
//---- initialization done
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator deinitialization function                       |
//+------------------------------------------------------------------+
int deinit()
  {
//---- TODO: add your code here
   
//----
   return(0);
  }
//+------------------------------------------------------------------+
//| Custom indicator iteration function                              |
//+------------------------------------------------------------------+
int start()
  {
   double haOpen, haHigh, haLow, haClose;
   if(Bars<=10) return(0);
   ExtCountedBars=IndicatorCounted();
//---- check for possible errors
   if (ExtCountedBars<0) return(-1);
//---- last counted bar will be recounted
   if (ExtCountedBars>0) ExtCountedBars--;
   int pos=Bars-ExtCountedBars-1;
   while(pos>=0)
     {
      haOpen=(ExtMapBuffer3[pos+1]+ExtMapBuffer4[pos+1])/2;
      haClose=(Open[pos]+High[pos]+Low[pos]+Close[pos])/4;
      haHigh=MathMax(High[pos], MathMax(haOpen, haClose));
      haLow=MathMin(Low[pos], MathMin(haOpen, haClose));
      if (haOpen<haClose) 
        {
         ExtMapBuffer1[pos]=haLow;
         ExtMapBuffer2[pos]=haHigh;
        } 
      else
        {
         ExtMapBuffer1[pos]=haHigh;
         ExtMapBuffer2[pos]=haLow;
        } 
      ExtMapBuffer3[pos]=haOpen;
      ExtMapBuffer4[pos]=haClose;
 	   pos--;
     }
//----
   return(0);
  }
//+------------------------------------------------------------------+